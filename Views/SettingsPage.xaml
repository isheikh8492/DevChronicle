<Page x:Class="DevChronicle.Views.SettingsPage"
      xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
      xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
      xmlns:ui="http://schemas.lepo.co/wpfui/2022/xaml"
      Title="Settings"
      Foreground="{DynamicResource TextFillColorPrimaryBrush}">

    <ScrollViewer>
        <StackPanel Margin="56,24,56,24">
            <TextBlock
                FontSize="28"
                FontWeight="SemiBold"
                Text="Settings"
                Margin="0,0,0,8"/>
            <TextBlock
                FontSize="14"
                Foreground="{DynamicResource TextFillColorSecondaryBrush}"
                Text="Configure application settings and preferences."
                Margin="0,0,0,24"/>

            <ui:Card Margin="0,0,0,16">
                <StackPanel Margin="20">
                    <StackPanel Orientation="Horizontal" Margin="0,0,0,12">
                        <ui:SymbolIcon Symbol="Key24" FontSize="20" Margin="0,0,12,0"/>
                        <TextBlock FontSize="16" FontWeight="Medium" Text="OpenAI API Configuration" VerticalAlignment="Center"/>
                    </StackPanel>
                    <TextBlock
                        FontSize="12"
                        Foreground="{DynamicResource TextFillColorSecondaryBrush}"
                        Text="API Key is stored securely in Windows Credential Manager"
                        Margin="0,0,0,12"/>
                    <ui:PasswordBox
                        PlaceholderText="Enter your OpenAI API key"
                        Margin="0,0,0,12"/>
                    <ui:Button
                        Content="Save API Key"
                        Icon="{ui:SymbolIcon Save24}"
                        Appearance="Primary"
                        HorizontalAlignment="Left"/>
                </StackPanel>
            </ui:Card>

            <ui:Card Margin="0,0,0,16">
                <StackPanel Margin="20">
                    <StackPanel Orientation="Horizontal" Margin="0,0,0,16">
                        <ui:SymbolIcon Symbol="Settings24" FontSize="20" Margin="0,0,12,0"/>
                        <TextBlock FontSize="16" FontWeight="Medium" Text="Processing Options" VerticalAlignment="Center"/>
                    </StackPanel>

                    <ui:CardControl Margin="0,0,0,12">
                        <StackPanel Margin="16">
                            <CheckBox Content="Include merge commits"
                                      Margin="0,0,0,8"
                                      FontSize="14"
                                      IsChecked="{Binding IncludeMerges, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"/>
                            <CheckBox Content="Include diffs in summarization"
                                      FontSize="14"
                                      IsChecked="{Binding IncludeDiffs, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"/>
                        </StackPanel>
                    </ui:CardControl>

                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="16"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>

                        <ui:CardControl Grid.Column="0">
                            <StackPanel Margin="16">
                                <TextBlock Text="Window size (days)" FontSize="12" Foreground="{DynamicResource TextFillColorSecondaryBrush}" Margin="0,0,0,8"/>
                                <ui:NumberBox Value="{Binding WindowSizeDays, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                              Minimum="1"
                                              Maximum="90"
                                              SpinButtonPlacementMode="Inline"/>
                            </StackPanel>
                        </ui:CardControl>

                        <ui:CardControl Grid.Column="2">
                            <StackPanel Margin="16">
                                <TextBlock Text="Max bullets per day" FontSize="12" Foreground="{DynamicResource TextFillColorSecondaryBrush}" Margin="0,0,0,8"/>
                                <ui:NumberBox Value="{Binding MaxBulletsPerDay, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                              Minimum="4"
                                              Maximum="10"
                                              SpinButtonPlacementMode="Inline"/>
                            </StackPanel>
                        </ui:CardControl>
                    </Grid>

                    <Grid Margin="0,16,0,0">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="16"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>

                        <ui:CardControl Grid.Column="0">
                            <StackPanel Margin="16">
                                <TextBlock Text="Overlap days" FontSize="12" Foreground="{DynamicResource TextFillColorSecondaryBrush}" Margin="0,0,0,8"/>
                                <ui:NumberBox Value="{Binding OverlapDays, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                              Minimum="0"
                                              Maximum="14"
                                              SpinButtonPlacementMode="Inline"/>
                            </StackPanel>
                        </ui:CardControl>

                        <ui:CardControl Grid.Column="2">
                            <StackPanel Margin="16">
                                <TextBlock Text="Backfill order" FontSize="12" Foreground="{DynamicResource TextFillColorSecondaryBrush}" Margin="0,0,0,8"/>
                                <ComboBox SelectedValuePath="Tag"
                                          SelectedValue="{Binding BackfillOrder, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}">
                                    <ComboBoxItem Content="Oldest first" Tag="OldestFirst"/>
                                    <ComboBoxItem Content="Newest first" Tag="NewestFirst"/>
                                    <ComboBoxItem Content="Fill gaps first" Tag="GappedFirst"/>
                                </ComboBox>
                            </StackPanel>
                        </ui:CardControl>
                    </Grid>

                    <ui:CardControl Margin="0,12,0,0">
                        <StackPanel Margin="16">
                            <CheckBox Content="Fill gaps first"
                                      FontSize="14"
                                      IsChecked="{Binding FillGapsFirst, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"/>
                        </StackPanel>
                    </ui:CardControl>
                </StackPanel>
            </ui:Card>

            <ui:Card>
                <StackPanel Margin="20">
                    <StackPanel Orientation="Horizontal" Margin="0,0,0,12">
                        <ui:SymbolIcon Symbol="Info24" FontSize="20" Margin="0,0,12,0"/>
                        <TextBlock FontSize="16" FontWeight="Medium" Text="About" VerticalAlignment="Center"/>
                    </StackPanel>
                    <TextBlock FontSize="14" Text="DevChronicle" FontWeight="Medium" Margin="0,0,0,4"/>
                    <TextBlock FontSize="12" Foreground="{DynamicResource TextFillColorSecondaryBrush}" Text="Version 1.0.0 (MVP)" Margin="0,0,0,4"/>
                    <TextBlock FontSize="12" Foreground="{DynamicResource TextFillColorSecondaryBrush}" Text="Session-based developer diary and resume generator from Git history"/>
                </StackPanel>
            </ui:Card>
        </StackPanel>
    </ScrollViewer>
</Page>
